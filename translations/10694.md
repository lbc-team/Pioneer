
>- åŸæ–‡é“¾æ¥ï¼š[www.quicknode.com/guides...](https://www.quicknode.com/guides/solana-development/anchor/transfer-tokens)
>- è¯‘è€…ï¼š[AIç¿»è¯‘å®˜](https://learnblockchain.cn/people/19584)ï¼Œæ ¡å¯¹ï¼š[ç¿»è¯‘å°ç»„](https://learnblockchain.cn/people/412)
>- æœ¬æ–‡é“¾æ¥ï¼š[learnblockchain.cn/articleâ€¦](https://learnblockchain.cn/article/10694)
    
### æ¦‚è¿°

[Anchor](https://www.anchor-lang.com/) æ˜¯ä¸€ä¸ªåŠ é€Ÿåœ¨ Solana åŒºå—é“¾ä¸Šå¼€å‘å®‰å…¨ç¨‹åºçš„æ¡†æ¶ã€‚åœ¨ä½¿ç”¨ Solana å’Œ Anchor æ—¶ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°éœ€è¦åœ¨è´¦æˆ·ä¹‹é—´å‘é€ SOL æˆ– SPL ä»£å¸çš„æƒ…å†µï¼ˆä¾‹å¦‚ï¼Œå¤„ç†ç”¨æˆ·æ”¯ä»˜åˆ°ä½ çš„å›½åº“ï¼Œæˆ–è®©ç”¨æˆ·å°†ä»–ä»¬çš„ NFT å‘é€åˆ°æ‰˜ç®¡è´¦æˆ·ï¼‰ã€‚æœ¬æŒ‡å—å°†å¼•å¯¼ä½ é€šè¿‡ä½¿ç”¨ Anchor è½¬ç§» SOL å’Œ SPL ä»£å¸çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬å°†æ¶µç›–ç¨‹åºå’Œæµ‹è¯•æ‰€éœ€çš„ä»£ç ï¼Œä»¥ç¡®ä¿è´¦æˆ·ä¹‹é—´çš„ä»£å¸æ— ç¼è½¬ç§»ã€‚

#### ä½ å°†åšä»€ä¹ˆ

åœ¨æœ¬æŒ‡å—ä¸­ï¼Œä½ å°†ï¼š

*   ä½¿ç”¨ Anchor å’Œ [Solana Playground](https://beta.solpg.io/) åˆ›å»ºä¸€ä¸ª Solana ç¨‹åº
*   åˆ›å»ºä¸€ä¸ªç¨‹åºæŒ‡ä»¤ï¼Œå°† SOL åœ¨ä¸¤ä¸ªç”¨æˆ·ä¹‹é—´å‘é€
*   åˆ›å»ºä¸€ä¸ªç¨‹åºæŒ‡ä»¤ï¼Œå°† SPL ä»£å¸åœ¨ä¸¤ä¸ªç”¨æˆ·ä¹‹é—´å‘é€
*   ç¼–å†™æµ‹è¯•ä»¥éªŒè¯ä»£å¸è½¬ç§»

#### ä½ å°†éœ€è¦ä»€ä¹ˆ

*   å…·æœ‰ä½¿ç”¨ Anchor å¼€å‘çš„åŸºæœ¬ç»éªŒï¼ˆ [æŒ‡å—ï¼šä½¿ç”¨ Anchor å…¥é—¨](https://www.quicknode.com/guides/solana-development/how-to-write-your-first-anchor-program-in-solana-part-1) ï¼‰
*   å…·æœ‰ Solana è½¬è´¦çš„ç»éªŒï¼ˆ [æŒ‡å—ï¼šå¦‚ä½•ä½¿ç”¨ JavaScript å‘é€ SOL](https://www.quicknode.com/guides/solana-development/transactions/how-to-send-a-transaction-on-solana-using-javascript/)ï¼‰å’Œ SPL ä»£å¸è½¬è´¦ï¼ˆ [æŒ‡å—ï¼šå¦‚ä½•è½¬ç§» SPL ä»£å¸](https://www.quicknode.com/guides/solana-development/spl-tokens/how-to-transfer-spl-tokens-on-solana/) ï¼‰
*   å¯¹ JavaScript/TypeScript å’Œ Rust ç¼–ç¨‹è¯­è¨€çš„åŸºæœ¬çŸ¥è¯†
*   ä¸€æ¬¾ç°ä»£ç½‘é¡µæµè§ˆå™¨ï¼ˆä¾‹å¦‚ï¼Œ [Google Chrome](https://www.google.com/chrome/)ï¼‰

#### æœ¬æŒ‡å—ä¸­ä½¿ç”¨çš„ä¾èµ–é¡¹ 

| ä¾èµ–é¡¹ | ç‰ˆæœ¬ |
| --- | --- |
| anchor-lang | 0.26.0 |
| anchor-spl | 0.26.0 |
| solana-program | 1.14.12 |
| spl-token | 3.5.0 |

## å¯åŠ¨ä½ çš„é¡¹ç›® 

é€šè¿‡è®¿é—® [https://beta.solpg.io/](https://beta.solpg.io/) åœ¨ Solana Playground åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ã€‚Solana Playground æ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„ Solana ä»£ç ç¼–è¾‘å™¨ï¼Œå¯ä»¥è®©æˆ‘ä»¬å¿«é€Ÿå¯åŠ¨è¿™ä¸ªé¡¹ç›®ã€‚ä½ å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ç¼–è¾‘å™¨ä¸­è·Ÿéšï¼Œä½†æœ¬æŒ‡å—å°†æ ¹æ® Solana Playground çš„å¿…éœ€æ­¥éª¤è¿›è¡Œè°ƒæ•´ã€‚é¦–å…ˆï¼Œç‚¹å‡»â€œåˆ›å»ºæ–°é¡¹ç›®â€ï¼š

![åˆ›å»ºæ–°é¡¹ç›®](https://img.learnblockchain.cn/attachments/migrate/1738834868299)

è¾“å…¥é¡¹ç›®åç§°â€œtransfersâ€ï¼Œé€‰æ‹©â€œAnchor (Rust)â€ï¼š

![å‘½åé¡¹ç›®](https://img.learnblockchain.cn/attachments/migrate/1738834868393)

## åˆ›å»ºå¹¶è¿æ¥é’±åŒ… 

ç”±äºæ­¤é¡¹ç›®ä»…ç”¨äºæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªâ€œä¸´æ—¶â€é’±åŒ…ã€‚Solana Playground ä½¿åˆ›å»ºé’±åŒ…å˜å¾—ç®€å•ã€‚ä½ åº”è¯¥çœ‹åˆ°æµè§ˆå™¨çª—å£å·¦ä¸‹è§’æ˜¾ç¤ºçº¢ç‚¹â€œæœªè¿æ¥â€ã€‚ç‚¹å‡»å®ƒï¼š

![é’±åŒ…è®¾ç½®æŒ‰é’®](https://img.learnblockchain.cn/attachments/migrate/1738834868411)

Solana Playground å°†ä¸ºä½ ç”Ÿæˆä¸€ä¸ªé’±åŒ…ï¼ˆæˆ–è€…ä½ å¯ä»¥å¯¼å…¥è‡ªå·±çš„é’±åŒ…ï¼‰ã€‚å¯ä»¥ä¿å­˜ä»¥å¤‡åç”¨ï¼Œå½“ä½ å‡†å¤‡å¥½æ—¶ç‚¹å‡»ç»§ç»­ã€‚ä¸€ä¸ªæ–°çš„é’±åŒ…å°†è¢«åˆå§‹åŒ–å¹¶è¿æ¥åˆ° Solana å¼€å‘ç½‘ç»œã€‚Solana Playground ä¼šè‡ªåŠ¨å‘ä½ çš„æ–°é’±åŒ…ç©ºæŠ•ä¸€äº› SOLï¼Œä½†æˆ‘ä»¬ä¼šè¯·æ±‚ä¸€äº›é¢å¤–çš„ SOLï¼Œä»¥ç¡®ä¿æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„èµ„é‡‘æ¥éƒ¨ç½²æˆ‘ä»¬çš„ç¨‹åºã€‚åœ¨æµè§ˆå™¨ç»ˆç«¯ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ Solana CLI å‘½ä»¤ã€‚è¾“å…¥ `solana airdrop 2` å‘ä½ çš„é’±åŒ…ç©ºæŠ• 2 SOLã€‚ä½ çš„é’±åŒ…ç°åœ¨åº”å·²è¿æ¥åˆ°å¼€å‘ç½‘ç»œï¼Œä½™é¢ä¸º 6 SOLï¼š

![å‡†å¤‡å°±ç»ª](https://img.learnblockchain.cn/attachments/migrate/1738834868415)

ä½ å‡†å¤‡å¥½äº†ï¼è®©æˆ‘ä»¬å¼€å§‹æ„å»ºï¼

## åˆ›å»ºè½¬è´¦ç¨‹åº 

é¦–å…ˆæ‰“å¼€ `lib.rs` å¹¶åˆ é™¤å¯åŠ¨ä»£ç ã€‚æ‹¥æœ‰ä¸€ä¸ªç©ºç™½çš„ç•Œé¢åï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ„å»ºç¨‹åºã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å¯¼å…¥ä¸€äº›ä¾èµ–é¡¹ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°æ–‡ä»¶é¡¶éƒ¨ï¼š

    use anchor_lang::prelude::*;use anchor_spl::token::{self, Token, TokenAccount, Transfer as SplTransfer};use solana_program::system_instruction;declare_id!("11111111111111111111111111111111");

è¿™äº›å¯¼å…¥å°†å…è®¸æˆ‘ä»¬ä½¿ç”¨ Anchor æ¡†æ¶ã€SPL ä»£å¸ç¨‹åºå’Œç³»ç»Ÿç¨‹åºã€‚Solana Playground åœ¨æˆ‘ä»¬éƒ¨ç½²ç¨‹åºæ—¶å°†è‡ªåŠ¨æ›´æ–° `declare_id!`ã€‚

### åˆ›å»ºè½¬ç§» Lamports (SOL) å‡½æ•° 

è¦åˆ›å»ºä¸€ä¸ªè½¬ç§» SOLï¼ˆæˆ– lamportsï¼‰çš„å‡½æ•°ï¼Œæˆ‘ä»¬å¿…é¡»ä¸ºæˆ‘ä»¬çš„è½¬ç§»ä¸Šä¸‹æ–‡å®šä¹‰ä¸€ä¸ªç»“æ„ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ä½ çš„ç¨‹åºä¸­ï¼š

    #[derive(Accounts)]pub struct TransferLamports<'info> {    #[account(mut)]    pub from: Signer<'info>,    #[account(mut)]    pub to: AccountInfo<'info>,    pub system_program: Program<'info, System>,}

è¯¥ç»“æ„å®šä¹‰äº†ä¸€ä¸ªå°†ç­¾å transaction å¹¶å‘é€ SOL çš„ `from` è´¦æˆ·ï¼Œä¸€ä¸ªå°†æ¥æ”¶ SOL çš„ `to` è´¦æˆ·ï¼Œä»¥åŠå¤„ç†è½¬è´¦çš„ç³»ç»Ÿç¨‹åºã€‚å±æ€§ `#[account(mut)]` è¡¨ç¤ºç¨‹åºå°†ä¿®æ”¹è¯¥è´¦æˆ·ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åˆ›å»ºå¤„ç†è½¬è´¦çš„å‡½æ•°ã€‚å°†ä»¥ä¸‹å†…å®¹æ·»åŠ åˆ°ä½ çš„ç¨‹åºä¸­ï¼š

    #[program]pub mod solana_lamport_transfer {    use super::*;    pub fn transfer_lamports(ctx: Context<TransferLamports>, amount: u64) -> Result<()> {        let from_account = &ctx.accounts.from;        let to_account = &ctx.accounts.to;        // åˆ›å»ºè½¬è´¦æŒ‡ä»¤        let transfer_instruction = system_instruction::transfer(from_account.key, to_account.key, amount);        // è°ƒç”¨è½¬è´¦æŒ‡ä»¤        anchor_lang::solana_program::program::invoke_signed(            &transfer_instruction,            &[                from_account.to_account_info(),                to_account.clone(),                ctx.accounts.system_program.to_account_info(),            ],            &[],        )?;        Ok(())    }}

ä»¥ä¸‹æ˜¯è¯¥ä»£ç ç‰‡æ®µä¸åŒéƒ¨åˆ†çš„ç®€è¦è§£é‡Šï¼š

1.  `#[program]` å±æ€§å°†æ¨¡å—æ ‡è®°ä¸º Anchor ç¨‹åºã€‚å®ƒç”Ÿæˆæ‰€éœ€çš„æ¨¡æ¿ä»¥å®šä¹‰ç¨‹åºçš„å…¥å£ç‚¹ï¼Œå¹¶è‡ªåŠ¨å¤„ç†è´¦æˆ·éªŒè¯å’Œååºåˆ—åŒ–ã€‚
    
2.  åœ¨ `solana_lamport_transfer` æ¨¡å—å†…éƒ¨ï¼Œä½¿ç”¨ `use super::*;` å¯¼å…¥çˆ¶æ¨¡å—æ‰€éœ€çš„é¡¹ã€‚
    
3.  `transfer_lamports` å‡½æ•°æ¥å—ä¸€ä¸ª _Context_ å’Œä¸€ä¸ª `amount` ä½œä¸ºå…¶å‚æ•°ã€‚_Context_ åŒ…å«äº¤æ˜“æ‰€éœ€çš„è´¦æˆ·ä¿¡æ¯ï¼Œ`amount` æ˜¯è¦è½¬ç§»çš„ lamports æ•°é‡ã€‚
    
4.  æˆ‘ä»¬åˆ›å»ºå¯¹ä¸Šä¸‹æ–‡ä¸­çš„ `from_account` å’Œ `to_account` çš„å¼•ç”¨ï¼Œè¿™äº›å¼•ç”¨å°†ç”¨äºè½¬è´¦ã€‚
    
5.  `system_instruction::transfer` å‡½æ•°åˆ›å»ºä¸€ä¸ªè½¬è´¦æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤æ¥å— `from_account` çš„å…¬é’¥ã€`to_account` çš„å…¬é’¥ä»¥åŠè¦è½¬ç§»çš„ `amount` ä½œä¸ºå‚æ•°ã€‚
    
6.  `anchor_lang::solana_program::program::invoke_signed` å‡½æ•°è°ƒç”¨è½¬è´¦æŒ‡ä»¤ï¼Œå¹¶ä½¿ç”¨äº¤æ˜“çš„ç­¾åè€…ï¼ˆ`from_account`ï¼‰ã€‚å®ƒæ¥å—è½¬è´¦æŒ‡ä»¤ã€`from_account`ã€`to_account` å’Œ `system_program` çš„è´¦æˆ·ä¿¡æ¯æ•°ç»„ï¼Œä»¥åŠä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºç­¾åè€…ã€‚
    
7.  `transfer_lamports` å‡½æ•°è¿”å› `Ok(())` ä»¥è¡¨ç¤ºæ‰§è¡ŒæˆåŠŸã€‚
    

ä½ å¯ä»¥é€šè¿‡ç‚¹å‡» `Build` æŒ‰é’®æˆ–åœ¨ç»ˆç«¯ä¸­è¾“å…¥ `anchor build` æ¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ã€‚å¦‚æœå‡ºç°é”™è¯¯ï¼Œè¯·æ£€æŸ¥ä½ çš„ä»£ç ä¸æœ¬æŒ‡å—ä¸­çš„ä»£ç å¹¶éµå¾ªé”™è¯¯å“åº”çš„å»ºè®®ã€‚å¦‚æœä½ éœ€è¦å¸®åŠ©ï¼Œè¯·éšæ—¶é€šè¿‡ [Discord](https://discord.gg/quicknode) è”ç³»æˆ‘ä»¬ã€‚

### åˆ›å»ºè½¬ç§» SPL ä»£å¸çš„åŠŸèƒ½

åœ¨æˆ‘ä»¬éƒ¨ç½²ç¨‹åºä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªç¬¬äºŒä¸ªåŠŸèƒ½æ¥è½¬ç§» SPL ä»£å¸ã€‚é¦–å…ˆï¼Œåˆ›å»ºè¯¥åŠŸèƒ½çš„æ–°ä¸Šä¸‹æ–‡ã€‚åœ¨ä½ çš„ç¨‹åºä¸­ `_TransferLamports_` ç»“æ„ä¸‹æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```rust
#[derive(Accounts)]
pub struct TransferSpl<'info> {
    pub from: Signer<'info>,
    #[account(mut)]
    pub from_ata: Account<'info, TokenAccount>,
    #[account(mut)]
    pub to_ata: Account<'info, TokenAccount>,
    pub token_program: Program<'info, Token>,
}
```

æ­¤ç»“æ„å°†éœ€è¦ `from` é’±åŒ…ï¼ˆæˆ‘ä»¬çš„ç­¾åè€…ï¼‰ã€æ¥è‡ªé’±åŒ…çš„å…³è”ä»£å¸è´¦æˆ·ï¼ˆATAï¼‰ã€ç›®çš„é’±åŒ…çš„ ATA å’Œä»£å¸ç¨‹åºã€‚ä½ ä¸éœ€è¦ç›®çš„é’±åŒ…çš„ä¸»è´¦æˆ·ï¼Œå› ä¸ºå®ƒå°†ä¿æŒä¸å˜ï¼ˆåªæœ‰å…¶ ATA ä¼šè¢«ä¿®æ”¹ï¼‰ã€‚ç°åœ¨è®©æˆ‘ä»¬åˆ›å»ºæˆ‘ä»¬çš„å‡½æ•°ã€‚åœ¨ `solana_lamport_transfer` æ¨¡å—ä¸­ï¼Œåœ¨ `transfer_lamports` æŒ‡ä»¤ä¸‹ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```rust
pub fn transfer_spl_tokens(ctx: Context<TransferSpl>, amount: u64) -> Result<()> {
    let destination = &ctx.accounts.to_ata;
    let source = &ctx.accounts.from_ata;
    let token_program = &ctx.accounts.token_program;
    let authority = &ctx.accounts.from;
    
    // ä»æ‰¿æ¥è€…è½¬è´¦ç»™åˆå§‹åŒ–è€…
    let cpi_accounts = SplTransfer {
        from: source.to_account_info().clone(),
        to: destination.to_account_info().clone(),
        authority: authority.to_account_info().clone(),
    };
    let cpi_program = token_program.to_account_info();
    
    token::transfer(
        CpiContext::new(cpi_program, cpi_accounts),
        amount
    )?;
    Ok(())
}
```

è®©æˆ‘ä»¬é€æ­¥åˆ†æè¿™ä¸ªå‡½æ•°ï¼š

1. `transfer_spl_tokens` å‡½æ•°æ¥å—ä¸€ä¸ª _Context_ å’Œä¸€ä¸ª `amount` ä½œä¸ºå‚æ•°ã€‚_TransferSpl_ ä¸Šä¸‹æ–‡åŒ…å«æˆ‘ä»¬åœ¨å‰ä¸€æ­¥ä¸­å®šä¹‰çš„äº¤æ˜“æ‰€éœ€è´¦æˆ·ä¿¡æ¯ã€‚
    
2. æˆ‘ä»¬ä»ä¸Šä¸‹æ–‡ä¸­åˆ›å»ºå¯¹ `destination`ã€`source`ã€`token_program` å’Œ `authority` çš„å¼•ç”¨ã€‚è¿™äº›å˜é‡åˆ†åˆ«ä»£è¡¨ç›®çš„ ATAã€æº ATAã€ä»£å¸ç¨‹åºå’Œç­¾åè€…çš„é’±åŒ…ã€‚
    
3. ä½¿ç”¨ `source`ã€`destination` å’Œ `authority` çš„è´¦æˆ·ä¿¡æ¯åˆ›å»º _SplTransfer_ ç»“æ„ã€‚å½“è¿›è¡Œè·¨ç¨‹åºè°ƒç”¨ï¼ˆCPIï¼‰åˆ° SPL Token ç¨‹åºæ—¶ï¼Œæ­¤ç»“æ„å°†æä¾›è´¦æˆ·ä¿¡æ¯ã€‚
    
4. ä½¿ç”¨ `cpi_program` å’Œ `cpi_accounts` ä»¥åŠè¦è½¬ç§»çš„ `amount` è°ƒç”¨ `token::transfer` å‡½æ•°ã€‚æ­¤å‡½æ•°æ‰§è¡ŒæŒ‡å®š ATA ä¹‹é—´çš„å®é™…ä»£å¸è½¬ç§»ã€‚
    
5. æˆ‘ä»¬è¿”å› `Ok(())` ä»¥è¡¨ç¤ºæˆåŠŸæ‰§è¡Œã€‚
    
ç»§ç»­æ„å»ºä½ çš„ç¨‹åºï¼Œä»¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸å·¥ä½œï¼Œæ–¹æ³•æ˜¯ç‚¹å‡»â€œBuildâ€æˆ–è¾“å…¥ `anchor build`ã€‚

å¦‚æœç¨‹åºæˆåŠŸæ„å»ºï¼Œä½ å¯ä»¥å°†å…¶éƒ¨ç½²åˆ° Solana å¼€å‘ç½‘ç»œã€‚

### éƒ¨ç½²ç¨‹åº

ç‚¹å‡»é¡µé¢å·¦ä¾§çš„å·¥å…·å›¾æ ‡ ğŸ› ï¼Œç„¶åç‚¹å‡»â€œDeployâ€ï¼š

![Deploy](https://img.learnblockchain.cn/attachments/migrate/1738834868417)

è¿™å¯èƒ½éœ€è¦ä¸€åˆ†é’Ÿæˆ–ä¸¤åˆ†é’Ÿï¼Œä½†å®Œæˆåï¼Œä½ åº”è¯¥åœ¨æµè§ˆå™¨ç»ˆç«¯ä¸­çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹çš„ä¿¡æ¯ï¼š

![Success](https://img.learnblockchain.cn/attachments/migrate/1738834868433)

å¹²å¾—å¥½ï¼è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ã€‚

## æµ‹è¯•ç¨‹åº

è¿”å›ä½ ç¼–è¾‘ `lib.rs` æ–‡ä»¶çš„ä¸»æ–‡ä»¶çª—å£ï¼Œç‚¹å‡»é¡µé¢å·¦ä¸Šè§’çš„ ğŸ“‘ å›¾æ ‡ã€‚æ‰“å¼€ `anchor.test.ts` å¹¶ç”¨ä»¥ä¸‹å†…å®¹æ›¿æ¢å…¶å†…å®¹ï¼š

```javascript
import {
  createMint,
  createAssociatedTokenAccount,
  mintTo,
  TOKEN_PROGRAM_ID,
} from "@solana/spl-token";

describe("Test transfers", () => {});
```

##### ç®€åŒ–è°ƒè¯•çš„æ—¥å¿—

ç°åœ¨ä½ å¯ä»¥è®¿é—® RPC ç«¯ç‚¹çš„æ—¥å¿—ï¼Œå¸®åŠ©ä½ æ›´æœ‰æ•ˆåœ°æ’é™¤é—®é¢˜ã€‚å¦‚æœä½ é‡åˆ° RPC è°ƒç”¨çš„é—®é¢˜ï¼Œåªéœ€åœ¨ä½ çš„ QuickNode ä»ªè¡¨æ¿ä¸­æ£€æŸ¥æ—¥å¿—ä»¥å¿«é€Ÿè¯†åˆ«å’Œè§£å†³é—®é¢˜ã€‚äº†è§£æ›´å¤šå…³äºæ—¥å¿—å†å²é™åˆ¶çš„å†…å®¹ï¼Œè¯·æŸ¥çœ‹ [æˆ‘ä»¬çš„å®šä»·é¡µé¢ã€‚](https://www.quicknode.com/pricing#features)

è¿™æ®µä»£ç å°†å¯¼å…¥ SPL Token ç¨‹åºä¸­åˆ›å»ºé“¸å¸ã€åˆ›å»ºå…³è”ä»£å¸è´¦æˆ·å’Œé“¸é€ ä»£å¸åˆ°å…³è”ä»£å¸è´¦æˆ·æ‰€éœ€çš„å‡½æ•°ã€‚è¿™è¿˜å°†ä¸ºæˆ‘ä»¬çš„ç¨‹åºåˆ›å»ºä¸€ä¸ªæµ‹è¯•å¥—ä»¶ã€‚

### æµ‹è¯•è½¬ç§» Lamports

åœ¨ä½ çš„æµ‹è¯•å¥—ä»¶ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š

```javascript
it("transferLamports", async () => {
    // ç”Ÿæˆæ–°è´¦æˆ·çš„å¯†é’¥å¯¹
    const newAccountKp = new web3.Keypair();
    // å‘é€äº¤æ˜“
    const data = new BN(1000000);
    const tx = await pg.program.methods
      .transferLamports(data)
      .accounts({
        from: pg.wallet.publicKey,
        to: newAccountKp.publicKey,
      })
      .signers([pg.wallet.keypair])
      .transaction();
    const txHash = await web3.sendAndConfirmTransaction(pg.program.provider.connection, tx, [pg.wallet.keypair]);
    console.log(`https://explorer.solana.com/tx/${txHash}?cluster=devnet`);
    const newAccountBalance = await pg.program.provider.connection.getBalance(
      newAccountKp.publicKey
    );
    assert.strictEqual(
      newAccountBalance,
      data.toNumber(),
      "The new account should have the transferred lamports"
    );
});
```

åœ¨è¿™ä¸ª `transferLamports` æµ‹è¯•ä¸­å‘ç”Ÿäº†ä»€ä¹ˆï¼š

1. æˆ‘ä»¬ä¸ºç›®çš„è´¦æˆ·ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯†é’¥å¯¹ã€‚
2. æˆ‘ä»¬å°†è½¬ç§»çš„é‡‘é¢å®šä¹‰ä¸º `data`ï¼Œå…¶å€¼è®¾ä¸º 1,000,000 lamports (0.001 SOL)ï¼ˆ_æ³¨æ„ï¼šAnchor æœŸæœ›æˆ‘ä»¬å°†æ­¤å€¼ä½œä¸ºå¤§æ•°å­—ç±»å‹ä¼ é€’_ï¼‰ã€‚
3. æˆ‘ä»¬é€šè¿‡è°ƒç”¨ `pg.program.methods.transferLamports(data)` æ‰§è¡Œ Solana ç¨‹åºçš„ `transferLamports` å‡½æ•°ã€‚è¯¥äº¤æ˜“ä½¿ç”¨ `accounts` æ–¹æ³•æŒ‡å®šæ‰€ç”¨è´¦æˆ·ï¼Œå…¶ä¸­ `from` è´¦æˆ·æ˜¯æµ‹è¯•é’±åŒ…çš„å…¬é’¥ï¼Œ`to` è´¦æˆ·æ˜¯æ–°ç”Ÿæˆè´¦æˆ·çš„å…¬é’¥ã€‚Anchor çŸ¥é“æˆ‘ä»¬éœ€è¦ç³»ç»Ÿç¨‹åºï¼Œå› æ­¤è¿™é‡Œä¸éœ€è¦ä¼ é€’å®ƒã€‚
4. äº¤æ˜“ä½¿ç”¨æµ‹è¯•é’±åŒ…çš„å¯†é’¥å¯¹è¿›è¡Œç­¾åï¼Œé€šè¿‡ `signers` æ–¹æ³•ä¼ é€’ã€‚
5. ä½¿ç”¨ `transaction()` æ–¹æ³•åˆ›å»ºäº¤æ˜“ã€‚
6. æµ‹è¯•ä½¿ç”¨ `sendAndConfirmTransaction()` ç­‰å¾…äº¤æ˜“è¢« _ç¡®è®¤_ã€‚åœ¨æˆ‘ä»¬æ£€æŸ¥æ–°è´¦æˆ·çš„ä½™é¢æ—¶ï¼Œç¡®ä¿å®ƒå·²æ›´æ–°ä¸ºè½¬ç§»çš„é‡‘é¢æ˜¯å¾ˆé‡è¦çš„ã€‚
7. ä½¿ç”¨ `getBalance()` è·å–æ–°è´¦æˆ·çš„ä½™é¢ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `newAccountBalance` å˜é‡ä¸­ã€‚
8. ä½¿ç”¨ `assert.strictEqual` è¿›è¡Œæ–­è¨€ï¼Œä»¥ç¡®è®¤æ–°è´¦æˆ·çš„ä½™é¢ä¸è½¬ç§»é‡‘é¢åŒ¹é…ã€‚åªæœ‰å½“ä½™é¢åŒ¹é…é¢„æœŸé‡‘é¢æ—¶ï¼Œæµ‹è¯•æ‰ä¼šæˆåŠŸã€‚

### æµ‹è¯•è½¬ç§» SPL ä»£å¸

åœ¨ä½ çš„ `transferLamports` æµ‹è¯•ä¹‹åï¼Œä½†åœ¨åŒä¸€ä¸ªæµ‹è¯•å¥—ä»¶ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæµ‹è¯•ä»¥æµ‹è¯•ä½ çš„ SPL ä»£å¸è½¬ç§»ï¼š

```javascript
it("transferSplTokens", async () => {
    // ä¸ºæ–°è´¦æˆ·ç”Ÿæˆå¯†é’¥å¯¹
    const fromKp = pg.wallet.keypair;
    const toKp = new web3.Keypair();
    // åˆ›å»ºæ–°çš„é“¸å¸å¹¶åˆå§‹åŒ–å®ƒ
    const mint = await createMint(
      pg.program.provider.connection,
      pg.wallet.keypair,
      fromKp.publicKey,
      null,
      0
    );
    // ä¸ºæ–°è´¦æˆ·åˆ›å»ºå…³è”ä»£å¸è´¦æˆ·
    const fromAta = await createAssociatedTokenAccount(
      pg.program.provider.connection,
      pg.wallet.keypair,
      mint,
      fromKp.publicKey
    );
    const toAta = await createAssociatedTokenAccount(
      pg.program.provider.connection,
      pg.wallet.keypair,
      mint,
      toKp.publicKey
    );
    // é“¸é€ ä»£å¸åˆ° 'from' å…³è”ä»£å¸è´¦æˆ·
    const mintAmount = 1000;
    await mintTo(
      pg.program.provider.connection,
      pg.wallet.keypair,
      mint,
      fromAta,
      pg.wallet.keypair.publicKey,
      mintAmount
    );
    // å‘é€äº¤æ˜“
    const transferAmount = new BN(500);
    const tx = await pg.program.methods
      .transferSplTokens(transferAmount)
      .accounts({
        from: fromKp.publicKey,
        fromAta: fromAta,
        toAta: toAta,
        tokenProgram: TOKEN_PROGRAM_ID,
      })
      .signers([pg.wallet.keypair, fromKp])
      .transaction();
    const txHash = await web3.sendAndConfirmTransaction(pg.program.provider.connection, tx, [pg.wallet.keypair, fromKp]);
    console.log(`https://explorer.solana.com/tx/${txHash}?cluster=devnet`);
    const toTokenAccount = await pg.connection.getTokenAccountBalance(toAta);
    assert.strictEqual(
      toTokenAccount.value.uiAmount,
      transferAmount.toNumber(),
      "The 'to' token account should have the transferred tokens"
    );
});
```

ä»¥ä¸‹æ˜¯ `transferSplTokens` æµ‹è¯•ä¸­å‘ç”Ÿçš„äº‹æƒ…ï¼š

1.  æˆ‘ä»¬ä¸ºç›®æ ‡è´¦æˆ·ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯†é’¥å¯¹ã€‚
2.  æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é“¸å¸å¹¶åˆå§‹åŒ–å®ƒã€‚
3.  æˆ‘ä»¬ä¸ºæºé’±åŒ…å’Œç›®æ ‡é’±åŒ…åˆ›å»ºä¸æ–°ä»£å¸é“¸å¸å…³è”çš„å…³è”ä»£å¸è´¦æˆ·ã€‚
4.  æˆ‘ä»¬å‘æºï¼ˆæ¥è‡ªé’±åŒ…ï¼‰çš„å…³è”ä»£å¸è´¦æˆ·é“¸é€  1,000 ä¸ªä»£å¸ã€‚
5.  æˆ‘ä»¬æ‰§è¡Œåœ¨ç¨‹åºä¸­åˆ›å»ºçš„ `transferSplTokens` æŒ‡ä»¤ã€‚æ­¤æ¬¡äº¤æ˜“ä½¿ç”¨çš„è´¦æˆ·é€šè¿‡ accounts æ–¹æ³•æŒ‡å®šï¼Œå…¶ä¸­ `from` å¸æˆ·æ˜¯æµ‹è¯•é’±åŒ…çš„å…¬é’¥ï¼Œ`fromAta` å¸æˆ·æ˜¯æºå…³è”ä»£å¸è´¦æˆ·ï¼Œ`toAta` å¸æˆ·æ˜¯ç›®æ ‡å…³è”ä»£å¸è´¦æˆ·ï¼Œè€Œ `tokenProgram` æ˜¯ SPL Token ç¨‹åº IDã€‚
6.  ä½¿ç”¨ `transaction()` æ–¹æ³•åˆ›å»ºäº¤æ˜“ã€‚
7.  æµ‹è¯•é€šè¿‡ await `sendAndConfirmTransaction()` ç­‰å¾…äº¤æ˜“è¢« _æœ€ç»ˆç¡®å®š_ã€‚è¿™å¯¹äºç¡®ä¿å½“æˆ‘ä»¬æ£€æŸ¥æ–°è´¦æˆ·çš„ä½™é¢æ—¶ï¼Œå·²æ›´æ–°ä¸ºè½¬ç§»çš„é‡‘é¢éå¸¸é‡è¦ã€‚
8.  ä½¿ç”¨ `getTokenAccountBalance()` è·å–æ–°ä»£å¸è´¦æˆ·çš„ä½™é¢ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨ `toTokenAccount` å˜é‡ä¸­ã€‚
9.  ä½¿ç”¨ `assert.strictEqual` è¿›è¡Œæ–­è¨€ä»¥ç¡®è®¤æ–°è´¦æˆ·çš„ä½™é¢ä¸è½¬ç§»é‡‘é¢åŒ¹é…ã€‚ä»…å½“ä½™é¢ä¸é¢„æœŸé‡‘é¢åŒ¹é…æ—¶ï¼Œæµ‹è¯•æ‰ä¼šæˆåŠŸã€‚

å¹²å¾—ä¸é”™â€”â€”è®©æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹ï¼æŒ‰ä¸‹å±å¹•å·¦ä¾§çš„ **ğŸ§ª æµ‹è¯•** æŒ‰é’®è¿è¡Œæµ‹è¯•ã€‚ä½ åº”è¯¥ä¼šçœ‹åˆ°ä¸¤ä¸ªæµ‹è¯•éƒ½é€šè¿‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

    Running tests...  anchor.test.ts:  Test    https://explorer.solana.com/tx/5DNZm9oCtzMFSqUte6bt9tW5iW95AS77hSz8uqjZjD41rkJpCDLHRti6X7iRDrCfHRRGpMeAAePrVcKW4Qg3C9GB?cluster=devnet    âœ” transferLamports (13409ms)    https://explorer.solana.com/tx/3KCDqrbUonDBQSZfN8jFYZH8vo4fWgLfa3nCSWfCmeNgva3yVCeiy7QfiH9Az8U8LQpS1VKMELCH2wPDL4BcgKD6?cluster=devnet    âœ” transferSplTokens (15975ms)  2 passing (29s)

å°±è¿™æ ·ï¼å¹²å¾—å¥½ã€‚

## æ€»ç»“

ä½ å·²ç»ä½¿ç”¨è‡ªå·±çš„ Solana ç¨‹åºå®ç°äº†æœ¬åœ° SOL è½¬è´¦å’Œ SPL ä»£å¸è½¬è´¦ã€‚è¿™æ˜¯æ„å»ºè‡ªå·±çš„ NFT é¡¹ç›®ã€æ¸¸æˆæˆ– DeFi åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå¾ˆå¥½çš„å¼€å§‹ã€‚ç»§ç»­æ„å»ºå§ï¼

å¦‚æœä½ å¡ä½äº†ï¼Œæœ‰é—®é¢˜ï¼Œæˆ–è€…æƒ³èŠèŠä½ æ­£åœ¨æ„å»ºçš„å†…å®¹ï¼Œæ¬¢è¿é€šè¿‡ [Discord](https://discord.gg/quicknode) æˆ– [Twitter](https://twitter.com/QuickNode) è”ç³»æˆ‘ä»¬ï¼

#### æˆ‘ä»¬ â¤ï¸ åé¦ˆï¼

å¦‚æœä½ å¯¹æœ¬æŒ‡å—æœ‰ä»»ä½•åé¦ˆï¼Œ [å‘Šè¯‰æˆ‘ä»¬](https://airtable.com/shrKKKP7O1Uw3ZcUB?prefill_Guide+Name=How%20to%20Transfer%20Tokens%20Using%20Anchor) ã€‚æˆ‘ä»¬å¾ˆä¹æ„å¬å–ä½ çš„æ„è§ã€‚

> æˆ‘æ˜¯ [AI ç¿»è¯‘å®˜](https://learnblockchain.cn/people/19584)ï¼Œä¸ºå¤§å®¶è½¬è¯‘ä¼˜ç§€è‹±æ–‡æ–‡ç« ï¼Œå¦‚æœ‰ç¿»è¯‘ä¸é€šçš„åœ°æ–¹ï¼Œåœ¨[è¿™é‡Œ](https://github.com/lbc-team/Pioneer/blob/master/translations/10694.md)ä¿®æ”¹ï¼Œè¿˜è¯·åŒ…æ¶µï½